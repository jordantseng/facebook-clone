function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{V7sj:function(t,e,n){"use strict";var r,i=n("fXoL"),o=n("3Pt+"),a=n("ofXK"),c=n("Wp6s"),s=n("bTqV"),u=n("NFeN"),l=n("STbY"),f=["*"],m=((r=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||r)},r.\u0275cmp=i.Ib({type:r,selectors:[["app-util-buttons"]],inputs:{post:"post"},ngContentSelectors:f,decls:6,vars:1,consts:[["mat-icon-button","",3,"matMenuTriggerFor"],["more_options","matMenu"]],template:function(t,e){if(1&t&&(i.jc(),i.Tb(0,"button",0),i.Tb(1,"mat-icon"),i.xc(2,"more_horiz"),i.Sb(),i.Sb(),i.Tb(3,"mat-menu",null,1),i.ic(5),i.Sb()),2&t){var n=i.oc(4);i.kc("matMenuTriggerFor",n)}},directives:[s.b,l.c,u.a,l.d],styles:["[_nghost-%COMP%]{display:block;margin-left:auto}"]}),r),b=n("tyNb"),p=n("iz3X"),g=n("f0Cb"),d=n("kmnG"),h=n("qFsG");function v(t,e){if(1&t){var n=i.Ub();i.Tb(0,"app-util-buttons",8),i.Tb(1,"button",9),i.bc("click",(function(){i.qc(n);var t=i.fc().$implicit;return i.fc().onDeleteComment(t._id)})),i.xc(2," Delete "),i.Sb(),i.Sb()}if(2&t){var r=i.fc(2);i.kc("post",r.post)}}function k(t,e){if(1&t&&(i.Tb(0,"div",4),i.Pb(1,"img",5),i.Tb(2,"div",6),i.Tb(3,"strong"),i.xc(4),i.Sb(),i.Tb(5,"div"),i.xc(6),i.Sb(),i.Sb(),i.Tb(7,"div"),i.wc(8,v,3,1,"app-util-buttons",7),i.Sb(),i.Sb()),2&t){var n=e.$implicit,r=i.fc();i.Cb(1),i.kc("src",n.avatar,i.rc),i.Cb(3),i.yc(n.name),i.Cb(2),i.zc(" ",n.content," "),i.Cb(2),i.kc("ngIf",r.loggedinUser._id===n.user)}}var y,C=((y=function(){function t(e,n){_classCallCheck(this,t),this.fb=e,this.postsService=n}return _createClass(t,[{key:"ngOnInit",value:function(){this.form=this.fb.group({comment:[""]})}},{key:"onDeleteComment",value:function(t){this.postsService.deleteComment(this.post._id,t)}},{key:"onSubmitComment",value:function(){this.postsService.createComment(this.form.value,this.post._id,this.loggedinUser),this.form.get("comment").setValue("")}}]),t}()).\u0275fac=function(t){return new(t||y)(i.Ob(o.b),i.Ob(p.a))},y.\u0275cmp=i.Ib({type:y,selectors:[["app-comments-section"]],inputs:{comments:"comments",post:"post",loggedinUser:"loggedinUser"},decls:7,vars:2,consts:[[1,"example-form",3,"formGroup","keydown.enter"],[2,"width","100%","margin-top","1rem"],["matInput","","formControlName","comment"],["style","padding: 1rem 0; display: flex",4,"ngFor","ngForOf"],[2,"padding","1rem 0","display","flex"],["mat-card-avatar","",2,"display","block","margin-right","1rem",3,"src"],[2,"flex","3"],[3,"post",4,"ngIf"],[3,"post"],["mat-menu-item","","color","warn",3,"click"]],template:function(t,e){1&t&&(i.Pb(0,"mat-divider"),i.Tb(1,"form",0),i.bc("keydown.enter",(function(){return e.onSubmitComment()})),i.Tb(2,"mat-form-field",1),i.Tb(3,"mat-label"),i.xc(4,"Leave a comment"),i.Sb(),i.Pb(5,"textarea",2),i.Sb(),i.Sb(),i.wc(6,k,9,4,"div",3)),2&t&&(i.Cb(1),i.kc("formGroup",e.form),i.Cb(5),i.kc("ngForOf",e.comments))},directives:[g.a,o.k,o.g,o.d,d.c,d.g,h.a,o.a,o.f,o.c,a.k,c.c,a.l,m,l.a],styles:[""]}),y);n.d(e,"a",(function(){return O}));var S=function(t){return["./",t,"edit"]};function I(t,e){if(1&t){var n=i.Ub();i.Tb(0,"app-util-buttons",11),i.Tb(1,"a",12),i.xc(2," Edit "),i.Sb(),i.Tb(3,"button",13),i.bc("click",(function(){i.qc(n);var t=i.fc().$implicit;return i.fc().onDeleteClick(t._id)})),i.xc(4," Delete "),i.Sb(),i.Sb()}if(2&t){var r=i.fc().$implicit;i.kc("post",r),i.Cb(1),i.kc("routerLink",i.mc(2,S,r._id))}}function _(t,e){if(1&t&&(i.Tb(0,"div",14),i.Pb(1,"img",15),i.Sb()),2&t){var n=i.fc().$implicit;i.Cb(1),i.kc("src",n.image,i.rc)("alt",n.title)}}function P(t,e){if(1&t&&i.Pb(0,"app-comments-section",16),2&t){var n=i.fc().$implicit,r=i.fc();i.kc("comments",n.comments)("loggedinUser",r.loggedinUser)("post",n)}}function T(t,e){if(1&t){var n=i.Ub();i.Tb(0,"div",1),i.Tb(1,"mat-card"),i.Tb(2,"mat-card-header"),i.Pb(3,"img",2),i.Tb(4,"mat-card-title"),i.xc(5),i.Sb(),i.Tb(6,"mat-card-subtitle"),i.xc(7),i.gc(8,"date"),i.Sb(),i.wc(9,I,5,4,"app-util-buttons",3),i.Sb(),i.Tb(10,"mat-card-content"),i.Tb(11,"h3"),i.xc(12),i.Sb(),i.Tb(13,"p"),i.xc(14),i.Sb(),i.wc(15,_,2,2,"div",4),i.Sb(),i.Tb(16,"mat-card-actions",5),i.Tb(17,"div",6),i.Tb(18,"button",7),i.xc(19),i.Sb(),i.Sb(),i.Tb(20,"div"),i.Tb(21,"button",8),i.bc("click",(function(){i.qc(n);var t=e.$implicit;return i.fc().onCommentButtonClick(t._id)})),i.xc(22),i.Sb(),i.Tb(23,"button",8),i.bc("click",(function(){i.qc(n);var t=e.$implicit;return i.fc().onLikeClick(t._id)})),i.Tb(24,"mat-icon",9),i.xc(25),i.Sb(),i.xc(26," LIKE "),i.Sb(),i.Sb(),i.Sb(),i.wc(27,P,1,3,"app-comments-section",10),i.Sb(),i.Sb()}if(2&t){var r=e.$implicit,o=i.fc();i.Cb(3),i.kc("src",r.user.avatar,i.rc),i.Cb(2),i.yc(r.user.name),i.Cb(2),i.yc(i.hc(8,11,r.createdAt)),i.Cb(2),i.kc("ngIf",o.loggedinUser._id===r.user._id),i.Cb(3),i.yc(r.title),i.Cb(2),i.zc(" ",r.content," "),i.Cb(1),i.kc("ngIf",r.image),i.Cb(4),i.yc(o.renderLikes(r)),i.Cb(3),i.zc(" ",o.renderCommentButton(r.comments)," "),i.Cb(3),i.yc(o.renderLikeButton(r.likes)),i.Cb(2),i.kc("ngIf",o.commentSection===r._id)}}var w,O=((w=function(){function t(e){_classCallCheck(this,t),this.fb=e,this.deleteClicked=new i.n,this.commentDeleted=new i.n,this.postLiked=new i.n}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"renderLikes",value:function(t){var e=this;return t.likes.find((function(t){return t.user===e.loggedinUser._id}))?1===t.likes.length?"You like this post":"You and other ".concat(t.likes.length-1," people like this post"):0===t.likes.length?null:"".concat(t.likes.length," people like this post")}},{key:"renderLikeButton",value:function(t){var e=this;return t.find((function(t){return t.user===e.loggedinUser._id}))?"favorite":"favorite_border"}},{key:"renderCommentButton",value:function(t){return t.length>0?"".concat(t.length," comments"):t.length<=0?"COMMENT":void 0}},{key:"onLikeClick",value:function(t){this.postLiked.emit({postId:t})}},{key:"onCommentButtonClick",value:function(t){this.commentSection=this.commentSection!==t?t:""}},{key:"onDeleteClick",value:function(t){this.deleteClicked.emit(t)}},{key:"onDeleteComment",value:function(t,e){this.commentDeleted.emit({postId:t,commentId:e})}}]),t}()).\u0275fac=function(t){return new(t||w)(i.Ob(o.b))},w.\u0275cmp=i.Ib({type:w,selectors:[["app-post-list"]],inputs:{posts:"posts",loggedinUser:"loggedinUser"},outputs:{deleteClicked:"deleteClicked",commentDeleted:"commentDeleted",postLiked:"postLiked"},decls:1,vars:1,consts:[["class","container",4,"ngFor","ngForOf"],[1,"container"],["mat-card-avatar","",3,"src"],[3,"post",4,"ngIf"],["class","image-container",4,"ngIf"],["align","end",2,"margin-bottom","0"],[2,"margin-right","auto"],["mat-button",""],["mat-button","",3,"click"],["color","warn"],[3,"comments","loggedinUser","post",4,"ngIf"],[3,"post"],["mat-menu-item","","routerLinkActive","router-link-active",3,"routerLink"],["mat-menu-item","","color","warn",3,"click"],[1,"image-container"],["mat-card-image","",3,"src","alt"],[3,"comments","loggedinUser","post"]],template:function(t,e){1&t&&i.wc(0,T,28,13,"div",0),2&t&&i.kc("ngForOf",e.posts)},directives:[a.k,c.a,c.e,c.c,c.i,c.h,a.l,c.d,c.b,s.b,u.a,m,b.d,l.a,b.c,c.f,C],pipes:[a.e],styles:[".container[_ngcontent-%COMP%]{margin:1rem 0}mat-card-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}.image-container[_ngcontent-%COMP%]{padding:10px;height:300px}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:cover;object-fit:cover;height:100%}"]}),w)},f9fP:function(t,e,n){"use strict";var r=n("fXoL"),i=n("3Pt+"),o=n("LRne"),a=n("HDdC"),c=function(t){if(!t.value||"string"==typeof t.value)return Object(o.a)(null);var e=t.value,n=new FileReader;return new a.a((function(t){n.addEventListener("loadend",(function(e){var n,r="",i=!1,o=_createForOfIteratorHelper(new Uint8Array(e.target.result).subarray(0,4));try{for(o.s();!(n=o.n()).done;){r+=n.value.toString(16)}}catch(a){o.e(a)}finally{o.f()}switch(r){case"89504e47":i=!0;break;case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":i=!0;break;default:i=!1}t.next(i?null:{invalidMimeType:!0}),t.complete()})),n.readAsArrayBuffer(e)}))},s=n("Wp6s"),u=n("kmnG"),l=n("qFsG"),f=n("ofXK"),m=n("bTqV"),b=n("NFeN");function p(t,e){1&t&&(r.Rb(0),r.xc(1," title is required "),r.Qb())}function g(t,e){if(1&t&&(r.Tb(0,"mat-error"),r.wc(1,p,2,0,"ng-container",4),r.Sb()),2&t){var n=r.fc();r.Cb(1),r.kc("ngIf",n.form.get("title").getError("required"))}}function d(t,e){1&t&&(r.Rb(0),r.xc(1," content is required "),r.Qb())}function h(t,e){if(1&t&&(r.Tb(0,"mat-error"),r.wc(1,d,2,0,"ng-container",4),r.Sb()),2&t){var n=r.fc();r.Cb(1),r.kc("ngIf",n.form.get("content").getError("required"))}}function v(t,e){if(1&t&&(r.Tb(0,"div",13),r.Pb(1,"img",14),r.Sb()),2&t){var n=r.fc();r.Cb(1),r.kc("src",n.imagePreview,r.rc)("alt",n.form.value.title)}}n.d(e,"a",(function(){return y}));var k,y=((k=function(){function t(e){_classCallCheck(this,t),this.fb=e,this.initialFormValue={title:"",content:"",image:""},this.formSubmitted=new r.n,this.form=this.fb.group({title:[this.initialFormValue.title,[i.j.required]],content:[this.initialFormValue.content,[i.j.required]],image:[null,null,[c]]})}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){for(var e in t)if(t.hasOwnProperty(e))switch(e){case"initialFormValue":return this.setFormValue()}}},{key:"setFormValue",value:function(){this.form.patchValue({title:this.initialFormValue.title,content:this.initialFormValue.content,image:this.initialFormValue.image}),this.imagePreview=this.initialFormValue.image}},{key:"onUploadImage",value:function(t){var e=this,n=t.target.files[0],r=new FileReader;n&&(this.form.patchValue({image:n}),this.form.get("image").updateValueAndValidity(),r.onload=function(t){e.imagePreview=t.target.result},r.readAsDataURL(n))}},{key:"onFormSubmit",value:function(){this.form.markAllAsTouched(),this.form.invalid||this.formSubmitted.emit(this.form.value)}}]),t}()).\u0275fac=function(t){return new(t||k)(r.Ob(i.b))},k.\u0275cmp=r.Ib({type:k,selectors:[["app-post-form"]],inputs:{loggedInUser:"loggedInUser",initialFormValue:"initialFormValue"},outputs:{formSubmitted:"formSubmitted"},features:[r.Ab],decls:22,vars:7,consts:[["mat-card-avatar","",3,"src"],[3,"formGroup","ngSubmit"],["formDirective","ngForm"],["matInput","","formControlName","title","placeholder","Post Title"],[4,"ngIf"],["matInput","","formControlName","content","placeholder","Post Content"],["class","image-preview",4,"ngIf"],[1,"post-form-actions"],["mat-button","","type","button",3,"click"],["color","warn"],["hidden","","type","file",3,"change"],["fileInput",""],["color","primary","mat-button","","type","submit",3,"disabled"],[1,"image-preview"],[3,"src","alt"]],template:function(t,e){if(1&t){var n=r.Ub();r.Tb(0,"mat-card"),r.Tb(1,"mat-card-header"),r.Pb(2,"img",0),r.Tb(3,"mat-card-title"),r.xc(4),r.Sb(),r.Sb(),r.Tb(5,"form",1,2),r.bc("ngSubmit",(function(){return e.onFormSubmit()})),r.Tb(7,"mat-form-field"),r.Pb(8,"input",3),r.Sb(),r.wc(9,g,2,1,"mat-error",4),r.Tb(10,"mat-form-field"),r.Pb(11,"textarea",5),r.Sb(),r.wc(12,h,2,1,"mat-error",4),r.wc(13,v,2,2,"div",6),r.Tb(14,"div",7),r.Tb(15,"button",8),r.bc("click",(function(){return r.qc(n),r.oc(19).click()})),r.Tb(16,"mat-icon",9),r.xc(17,"insert_photo"),r.Sb(),r.Sb(),r.Tb(18,"input",10,11),r.bc("change",(function(t){return e.onUploadImage(t)})),r.Sb(),r.Tb(20,"button",12),r.xc(21," Post "),r.Sb(),r.Sb(),r.Sb(),r.Sb()}2&t&&(r.Cb(2),r.kc("src",e.loggedInUser.avatar,r.rc),r.Cb(2),r.yc(e.loggedInUser.name),r.Cb(1),r.kc("formGroup",e.form),r.Cb(4),r.kc("ngIf",e.form.get("title").errors&&e.form.get("title").touched),r.Cb(3),r.kc("ngIf",e.form.get("content").errors&&e.form.get("content").touched),r.Cb(1),r.kc("ngIf",e.imagePreview),r.Cb(7),r.kc("disabled",e.form.invalid))},directives:[s.a,s.e,s.c,s.i,i.k,i.g,i.d,u.c,l.a,i.a,i.f,i.c,f.l,m.b,b.a,u.b],styles:["mat-form-field[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%}.image-preview[_ngcontent-%COMP%]{height:5rem;margin:1rem 0}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}.post-form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]}),k)},fZDh:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("fXoL"),i=n("tyNb"),o=n("iz3X"),a=n("oYgl"),c=n("f9fP"),s=function(){var t=function(){function t(e,n,r,i){_classCallCheck(this,t),this.route=e,this.router=n,this.postsService=r,this.authService=i,this.initialFormValue={title:"",content:"",image:""}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.authService.user$.subscribe((function(e){t.loggedInUser=e}))}},{key:"onCreatePost",value:function(t){var e=this;this.postsService.createPost(t).subscribe((function(){e.router.navigate(["./"],{relativeTo:e.route,queryParams:{ts:Date.now().toString()},queryParamsHandling:"merge",skipLocationChange:!0})}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(r.Ob(i.a),r.Ob(i.b),r.Ob(o.a),r.Ob(a.a))},t.\u0275cmp=r.Ib({type:t,selectors:[["app-create-post"]],decls:1,vars:2,consts:[[3,"loggedInUser","initialFormValue","formSubmitted"]],template:function(t,e){1&t&&(r.Tb(0,"app-post-form",0),r.bc("formSubmitted",(function(t){return e.onCreatePost(t)})),r.Sb()),2&t&&r.kc("loggedInUser",e.loggedInUser)("initialFormValue",e.initialFormValue)},directives:[c.a],styles:[""]}),t}()},iz3X:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2Vo4"),i=n("fXoL"),o=n("tk/3"),a=function(){var t=function(){function t(e){_classCallCheck(this,t),this.http=e,this.url="/api/posts",this.posts$=new r.a([]),this.page$=new r.a({pageSize:3,currentPage:1,totalData:0,totalPage:0})}return _createClass(t,[{key:"getPosts",value:function(){return this.posts$.getValue()}},{key:"fetchMyPosts",value:function(){var t=this;this.http.get("".concat(this.url,"/me")).subscribe((function(e){t.posts$.next(e.data)}))}},{key:"updateMyPost",value:function(t,e){var n;return"string"==typeof e.image&&(n=e),"object"==typeof e.image&&((n=new FormData).append("title",e.title),n.append("content",e.content),n.append("image",e.image)),this.http.put("".concat(this.url,"/").concat(t,"/me"),n)}},{key:"deleteMyPost",value:function(t){var e=this,n=this.posts$.getValue();this.posts$.next(this.posts$.getValue().filter((function(e){return e._id!==t}))),this.http.delete("".concat(this.url,"/").concat(t,"/me")).subscribe((function(){}),(function(t){e.posts$.next(n)}))}},{key:"createPost",value:function(t){var e=new FormData;return e.append("title",t.title),e.append("content",t.content),e.append("image",t.image),this.http.post(this.url,e)}},{key:"fetchPost",value:function(t){return this.http.get("".concat(this.url,"/").concat(t))}},{key:"deletePost",value:function(t){return this.http.delete("".concat(this.url,"/").concat(t))}},{key:"fetchPosts",value:function(t,e){var n=this;this.http.get("".concat(this.url,"?page=").concat(t,"&pageSize=").concat(e)).subscribe((function(t){n.posts$.next(t.data),n.page$.next(t.page)}))}},{key:"likePost",value:function(t,e){var n=this,r=_toConsumableArray(this.getPosts()),i=r.findIndex((function(e){return e._id===t})),o=_toConsumableArray(r[i].likes);r[i].likes.find((function(t){return t.user===e}))?r[i].likes=r[i].likes.filter((function(t){return t.user!==e})):r[i].likes.push({user:e}),this.posts$.next(r),this.http.patch("".concat(this.url,"/").concat(t,"/like"),{userId:e}).subscribe((function(t){var o=r[i].likes.findIndex((function(t){return t.user===e}));r[i].likes[o]=t,n.posts$.next(r)}),(function(t){r[i].likes=o,n.posts$.next(r)}))}},{key:"createComment",value:function(t,e,n){var r=_toConsumableArray(this.getPosts()),i=r.findIndex((function(t){return t._id===e})),o=_toConsumableArray(r[i].comments);r[i].comments=[].concat(_toConsumableArray(r[i].comments),[{user:n._id,avatar:n.avatar,name:n.name,content:t.comment}]),this.http.post("".concat(this.url,"/").concat(e,"/comments"),t).subscribe((function(t){var e=_toConsumableArray(r[i].comments);e[e.length-1]=t}),(function(t){r[i].comments=o}))}},{key:"deleteComment",value:function(t,e){var n=_toConsumableArray(this.getPosts()),r=n.findIndex((function(e){return e._id===t})),i=_toConsumableArray(n[r].comments),o=n[r].comments.filter((function(t){return t._id!==e}));n[r].comments=o,this.posts$.next(n),this.http.delete("".concat(this.url,"/").concat(t,"/comments/").concat(e)).subscribe((function(){}),(function(t){n[r].comments=i}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Xb(o.b))},t.\u0275prov=i.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},o0se:function(t,e,n){"use strict";n.r(e);var r=n("3Pt+"),i=n("ofXK"),o=n("tyNb"),a=n("eIep"),c=n("fXoL"),s=n("iz3X"),u=n("oYgl"),l=n("y9W9"),f=n("Wp6s"),m=n("bTqV");function b(t,e){if(1&t){var n=c.Ub();c.Tb(0,"mat-card"),c.Tb(1,"p"),c.xc(2),c.Sb(),c.Tb(3,"button",1),c.bc("click",(function(){return c.qc(n),c.fc().onCloseError()})),c.xc(4,"Close"),c.Sb(),c.Sb()}if(2&t){var r=c.fc();c.Cb(2),c.zc("Error occurred: ",r.errorMessage,"")}}var p,g=((p=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"onCloseError",value:function(){this.errorMessage=""}}]),t}()).\u0275fac=function(t){return new(t||p)},p.\u0275cmp=c.Ib({type:p,selectors:[["app-error"]],inputs:{errorMessage:"errorMessage"},decls:1,vars:1,consts:[[4,"ngIf"],["align","end","mat-raised-button","",3,"click"]],template:function(t,e){1&t&&c.wc(0,b,5,1,"mat-card",0),2&t&&c.kc("ngIf",e.errorMessage)},directives:[i.l,f.a,m.b],styles:["mat-card[_ngcontent-%COMP%]{display:flex;margin:0 0 1rem;background-color:#f8d7da;color:#721c24}p[_ngcontent-%COMP%]{margin:auto 0!important}button[_ngcontent-%COMP%]{margin-left:auto;color:#721c24}"]}),p),d=n("rQ3y"),h=n("f9fP");function v(t,e){1&t&&c.Pb(0,"app-spinner")}function k(t,e){if(1&t){var n=c.Ub();c.Tb(0,"app-post-form",3),c.bc("formSubmitted",(function(t){return c.qc(n),c.fc().onEditPost(t)})),c.Sb()}if(2&t){var r=c.fc();c.kc("loggedInUser",r.loggedInUser)("initialFormValue",r.initialFormValue)}}var y,C=((y=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this.route=e,this.router=n,this.postsService=r,this.authService=i,this.errorService=o,this.initialFormValue={title:"",content:"",image:""}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.errorSub=this.errorService.error$.subscribe((function(e){t.errorMessage=e.error.message})),this.authSub=this.authService.user$.subscribe((function(e){t.loggedInUser=e})),this.route.paramMap.pipe(Object(a.a)((function(e){return t.postId=e.get("id"),t.loading=!0,t.postsService.fetchPost(t.postId)}))).subscribe((function(e){t.initialFormValue=e,t.loading=!1}))}},{key:"onEditPost",value:function(t){var e=this;this.postsService.updateMyPost(this.postId,t).subscribe((function(){e.router.navigate(["../../"],{relativeTo:e.route})}))}},{key:"ngOnDestroy",value:function(){this.errorSub.unsubscribe(),this.authSub.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||y)(c.Ob(o.a),c.Ob(o.b),c.Ob(s.a),c.Ob(u.a),c.Ob(l.a))},y.\u0275cmp=c.Ib({type:y,selectors:[["app-edit-post"]],decls:3,vars:3,consts:[[4,"ngIf"],[3,"errorMessage"],[3,"loggedInUser","initialFormValue","formSubmitted",4,"ngIf"],[3,"loggedInUser","initialFormValue","formSubmitted"]],template:function(t,e){1&t&&(c.wc(0,v,1,0,"app-spinner",0),c.Pb(1,"app-error",1),c.wc(2,k,1,2,"app-post-form",2)),2&t&&(c.kc("ngIf",e.loading),c.Cb(1),c.kc("errorMessage",e.errorMessage),c.Cb(1),c.kc("ngIf",!e.loading))},directives:[i.l,g,d.a,h.a],styles:[""]}),y),S=n("M9IT"),I=n("fZDh"),_=n("V7sj");function P(t,e){1&t&&c.Pb(0,"app-spinner")}function T(t,e){if(1&t&&c.Pb(0,"app-error",5),2&t){var n=c.fc(2);c.kc("errorMessage",n.errorMessage)}}function w(t,e){if(1&t){var n=c.Ub();c.Rb(0),c.wc(1,T,1,1,"app-error",3),c.Pb(2,"app-create-post"),c.Tb(3,"app-post-list",4),c.bc("deleteClicked",(function(t){return c.qc(n),c.fc().onDeletePost(t)}))("commentSubmitted",(function(t){return c.qc(n),c.fc().onCommentSubmit(t)}))("postLiked",(function(t){return c.qc(n),c.fc().onClickLike(t)})),c.Sb(),c.Qb()}if(2&t){var r=c.fc();c.Cb(1),c.kc("ngIf",r.errorMessage),c.Cb(2),c.kc("posts",r.posts)("loggedinUser",r.loggedinUser)}}function O(t,e){1&t&&(c.Tb(0,"p",6),c.xc(1," No posts added yet.\n"),c.Sb())}var x,M,U=function(){return[1,3,5]},F=[{path:"",component:(x=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this.postsService=e,this.route=n,this.router=r,this.authService=i,this.errorService=o,this.posts=[],this.page={pageSize:3,currentPage:1,totalData:0,totalPage:0}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.userSub=this.authService.user$.subscribe((function(e){t.loggedinUser=e})),this.errorSub=this.errorService.error$.subscribe((function(e){t.loading=!1,t.errorMessage=e.error.message})),this.postsService.posts$.subscribe((function(e){t.loading=!1,t.posts=e})),this.postsService.page$.subscribe((function(e){t.loading=!1,t.page=e})),this.route.queryParamMap.subscribe((function(e){var n=+e.get("page")||t.page.currentPage,r=+e.get("pageSize")||t.page.pageSize;t.loading=!0,t.postsService.fetchPosts(n,r)}))}},{key:"onDeletePost",value:function(t){this.loading=!0,this.postsService.deleteMyPost(t)}},{key:"onClickLike",value:function(t){var e=t.postId;this.postsService.likePost(e,this.loggedinUser._id)}},{key:"onCommentSubmit",value:function(t){var e=t.commentValue,n=t.postId;this.postsService.createComment(e,n,this.loggedinUser)}},{key:"onChangePage",value:function(t){this.router.navigate(["./"],{relativeTo:this.route,queryParams:{page:t.pageIndex+1,pageSize:t.pageSize}})}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe(),this.errorSub.unsubscribe()}}]),t}(),x.\u0275fac=function(t){return new(t||x)(c.Ob(s.a),c.Ob(o.a),c.Ob(o.b),c.Ob(u.a),c.Ob(l.a))},x.\u0275cmp=c.Ib({type:x,selectors:[["app-post-list-home"]],decls:4,vars:7,consts:[[4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],["class","mat-body-1 info-text",4,"ngIf"],[3,"errorMessage",4,"ngIf"],[3,"posts","loggedinUser","deleteClicked","commentSubmitted","postLiked"],[3,"errorMessage"],[1,"mat-body-1","info-text"]],template:function(t,e){1&t&&(c.wc(0,P,1,0,"app-spinner",0),c.wc(1,w,4,3,"ng-container",0),c.Tb(2,"mat-paginator",1),c.bc("page",(function(t){return e.onChangePage(t)})),c.Sb(),c.wc(3,O,2,0,"p",2)),2&t&&(c.kc("ngIf",e.loading),c.Cb(1),c.kc("ngIf",e.loggedinUser&&!e.loading),c.Cb(1),c.kc("length",null==e.page?null:e.page.totalData)("pageSize",null==e.page?null:e.page.pageSize)("pageSizeOptions",c.lc(6,U)),c.Cb(1),c.kc("ngIf",e.posts.length<=0&&!e.loading))},directives:[i.l,S.a,d.a,I.a,_.a,g],styles:[""]}),x)},{path:":id/edit",component:C}],A=((M=function t(){_classCallCheck(this,t)}).\u0275mod=c.Mb({type:M}),M.\u0275inj=c.Lb({factory:function(t){return new(t||M)},imports:[[o.e.forChild(F)],o.e]}),M),V=n("rhD1"),L=n("Dk7Y");n.d(e,"PostsModule",(function(){return D}));var $,D=(($=function t(){_classCallCheck(this,t)}).\u0275mod=c.Mb({type:$}),$.\u0275inj=c.Lb({factory:function(t){return new(t||$)},imports:[[i.c,A,V.a,r.i,L.a],A]}),$)}}]);