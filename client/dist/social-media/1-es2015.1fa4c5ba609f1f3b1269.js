(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{V7sj:function(t,e,i){"use strict";var n=i("fXoL"),s=i("0IaG"),o=i("iz3X"),r=i("ofXK"),c=i("rQ3y"),a=i("Wp6s");function l(t,e){1&t&&n.Pb(0,"app-spinner")}function u(t,e){if(1&t&&(n.Tb(0,"div",2),n.Pb(1,"img",3),n.Tb(2,"div",4),n.Tb(3,"strong"),n.xc(4),n.Sb(),n.Sb(),n.Sb()),2&t){const t=e.$implicit;n.Cb(1),n.kc("src",t.avatar,n.rc),n.Cb(3),n.yc(t.name)}}function m(t,e){if(1&t&&(n.Rb(0),n.wc(1,u,5,2,"div",1),n.Qb()),2&t){const t=n.fc();n.Cb(1),n.kc("ngForOf",t.users)}}let b=(()=>{class t{constructor(t,e,i){this.dialogRef=t,this.postsService=e,this.postId=i.postId}ngOnInit(){this.loading=!0,this.postsService.getLikes(this.postId).subscribe(t=>{this.loading=!1,this.users=t})}}return t.\u0275fac=function(e){return new(e||t)(n.Ob(s.g),n.Ob(o.a),n.Ob(s.a))},t.\u0275cmp=n.Ib({type:t,selectors:[["app-likes-dialog"]],decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","style","display: flex; margin-top: 0.5rem",4,"ngFor","ngForOf"],["mat-dialog-content","",2,"display","flex","margin-top","0.5rem"],["mat-card-avatar","",2,"display","block","margin-right","1rem",3,"src"],[2,"margin","auto 0"]],template:function(t,e){1&t&&(n.wc(0,l,1,0,"app-spinner",0),n.wc(1,m,2,1,"ng-container",0)),2&t&&(n.kc("ngIf",e.loading),n.Cb(1),n.kc("ngIf",!e.loading))},directives:[r.l,c.a,r.k,s.e,a.c],styles:[""]}),t})();var p=i("bTqV"),g=i("NFeN"),d=i("STbY");const f=["*"];let h=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Ib({type:t,selectors:[["app-util-buttons"]],inputs:{post:"post"},ngContentSelectors:f,decls:6,vars:1,consts:[["mat-icon-button","",3,"matMenuTriggerFor"],["more_options","matMenu"]],template:function(t,e){if(1&t&&(n.jc(),n.Tb(0,"button",0),n.Tb(1,"mat-icon"),n.xc(2,"more_horiz"),n.Sb(),n.Sb(),n.Tb(3,"mat-menu",null,1),n.ic(5),n.Sb()),2&t){const t=n.oc(4);n.kc("matMenuTriggerFor",t)}},directives:[p.b,d.c,g.a,d.d],styles:["[_nghost-%COMP%]{display:block;margin-left:auto}"]}),t})();var k=i("tyNb"),S=i("3Pt+"),v=i("f0Cb"),C=i("ekhw");function I(t,e){if(1&t){const t=n.Ub();n.Tb(0,"app-util-buttons",7),n.Tb(1,"button",8),n.bc("click",(function(){n.qc(t);const e=n.fc().$implicit;return n.fc().onDeleteComment(e._id)})),n.xc(2," Delete "),n.Sb(),n.Sb()}if(2&t){const t=n.fc(2);n.kc("post",t.post)}}function P(t,e){if(1&t&&(n.Tb(0,"div",3),n.Pb(1,"img",4),n.Tb(2,"div",5),n.Tb(3,"strong"),n.xc(4),n.Sb(),n.Tb(5,"div"),n.xc(6),n.Sb(),n.Sb(),n.Tb(7,"div"),n.wc(8,I,3,1,"app-util-buttons",6),n.Sb(),n.Sb()),2&t){const t=e.$implicit,i=n.fc();n.Cb(1),n.kc("src",i.loggedinUser.avatar,n.rc),n.Cb(3),n.yc(i.loggedinUser.name),n.Cb(2),n.zc(" ",t.content," "),n.Cb(2),n.kc("ngIf",i.loggedinUser._id===t.user)}}let y=(()=>{class t{constructor(t,e){this.fb=t,this.postsService=e}ngOnInit(){this.form=this.fb.group({comment:[""]})}onDeleteComment(t){this.postsService.deleteComment(this.post._id,t)}onSubmitComment(){this.postsService.createComment(this.form.value,this.post._id,this.loggedinUser),this.form.get("comment").setValue("")}}return t.\u0275fac=function(e){return new(e||t)(n.Ob(S.b),n.Ob(o.a))},t.\u0275cmp=n.Ib({type:t,selectors:[["app-comments-section"]],inputs:{comments:"comments",post:"post",loggedinUser:"loggedinUser"},decls:4,vars:3,consts:[[1,"example-form",3,"formGroup","keydown.enter"],["label","Leave a comment",3,"control"],["style","padding: 1rem 0; display: flex",4,"ngFor","ngForOf"],[2,"padding","1rem 0","display","flex"],["mat-card-avatar","",2,"display","block","margin-right","1rem",3,"src"],[2,"flex","3"],[3,"post",4,"ngIf"],[3,"post"],["mat-menu-item","","color","warn",3,"click"]],template:function(t,e){1&t&&(n.Pb(0,"mat-divider"),n.Tb(1,"form",0),n.bc("keydown.enter",(function(){return e.onSubmitComment()})),n.Pb(2,"app-input",1),n.Sb(),n.wc(3,P,9,4,"div",2)),2&t&&(n.Cb(1),n.kc("formGroup",e.form),n.Cb(1),n.kc("control",e.form.get("comment")),n.Cb(1),n.kc("ngForOf",e.comments))},directives:[v.a,S.k,S.g,S.d,C.a,r.k,a.c,r.l,h,d.a],styles:[""]}),t})();i.d(e,"a",(function(){return M}));const w=function(t){return["./",t,"edit"]};function T(t,e){if(1&t){const t=n.Ub();n.Tb(0,"app-util-buttons",10),n.Tb(1,"a",11),n.xc(2," Edit "),n.Sb(),n.Tb(3,"button",12),n.bc("click",(function(){n.qc(t);const e=n.fc().$implicit;return n.fc().onDeleteClick(e._id)})),n.xc(4," Delete "),n.Sb(),n.Sb()}if(2&t){const t=n.fc().$implicit;n.kc("post",t),n.Cb(1),n.kc("routerLink",n.mc(2,w,t._id))}}function O(t,e){if(1&t&&(n.Tb(0,"div",13),n.Pb(1,"img",14),n.Sb()),2&t){const t=n.fc().$implicit;n.Cb(1),n.kc("src",t.image,n.rc)("alt",t.title)}}function $(t,e){if(1&t&&n.Pb(0,"app-comments-section",15),2&t){const t=n.fc().$implicit,e=n.fc();n.kc("comments",t.comments)("loggedinUser",e.loggedinUser)("post",t)}}function x(t,e){if(1&t){const t=n.Ub();n.Tb(0,"div",1),n.Tb(1,"mat-card"),n.Tb(2,"mat-card-header"),n.Pb(3,"img",2),n.Tb(4,"mat-card-title"),n.xc(5),n.Sb(),n.Tb(6,"mat-card-subtitle"),n.xc(7),n.gc(8,"date"),n.Sb(),n.wc(9,T,5,4,"app-util-buttons",3),n.Sb(),n.Tb(10,"mat-card-content"),n.Tb(11,"h3"),n.xc(12),n.Sb(),n.Tb(13,"p"),n.xc(14),n.Sb(),n.wc(15,O,2,2,"div",4),n.Sb(),n.Tb(16,"mat-card-actions",5),n.Tb(17,"div",6),n.Tb(18,"button",7),n.bc("click",(function(){n.qc(t);const i=e.$implicit;return n.fc().openLikesDialog(i)})),n.xc(19),n.Sb(),n.Sb(),n.Tb(20,"div"),n.Tb(21,"button",7),n.bc("click",(function(){n.qc(t);const i=e.$implicit;return n.fc().onCommentButtonClick(i._id)})),n.xc(22),n.Sb(),n.Tb(23,"button",7),n.bc("click",(function(){n.qc(t);const i=e.$implicit;return n.fc().onLikeClick(i._id)})),n.Tb(24,"mat-icon",8),n.xc(25),n.Sb(),n.xc(26," LIKE "),n.Sb(),n.Sb(),n.Sb(),n.wc(27,$,1,3,"app-comments-section",9),n.Sb(),n.Sb()}if(2&t){const t=e.$implicit,i=n.fc();n.Cb(3),n.kc("src",t.user.avatar,n.rc),n.Cb(2),n.yc(t.user.name),n.Cb(2),n.yc(n.hc(8,11,t.createdAt)),n.Cb(2),n.kc("ngIf",i.loggedinUser._id===t.user._id),n.Cb(3),n.yc(t.title),n.Cb(2),n.zc(" ",t.content," "),n.Cb(1),n.kc("ngIf",t.image),n.Cb(4),n.zc(" ",i.renderLikes(t)," "),n.Cb(3),n.zc(" ",i.renderCommentButton(t.comments)," "),n.Cb(3),n.yc(i.renderLikeButton(t.likes)),n.Cb(2),n.kc("ngIf",i.commentSection===t._id)}}let M=(()=>{class t{constructor(t){this.dialog=t,this.deleteClicked=new n.n,this.commentDeleted=new n.n,this.postLiked=new n.n}ngOnInit(){}renderLikes(t){return t.likes.find(t=>t===this.loggedinUser._id)?1===t.likes.length?"You like this post":`You and other ${t.likes.length-1} people like this post`:0===t.likes.length?null:`${t.likes.length} people like this post`}renderLikeButton(t){return t.find(t=>t===this.loggedinUser._id)?"favorite":"favorite_border"}renderCommentButton(t){return t.length>0?`${t.length} comments`:t.length<=0?"COMMENT":void 0}openLikesDialog(t){const e=new s.d;e.data={postId:t._id},this.dialog.open(b,e)}onLikeClick(t){this.postLiked.emit({postId:t})}onCommentButtonClick(t){this.commentSection=this.commentSection!==t?t:""}onDeleteClick(t){this.deleteClicked.emit(t)}onDeleteComment(t,e){this.commentDeleted.emit({postId:t,commentId:e})}}return t.\u0275fac=function(e){return new(e||t)(n.Ob(s.b))},t.\u0275cmp=n.Ib({type:t,selectors:[["app-post-list"]],inputs:{posts:"posts",loggedinUser:"loggedinUser"},outputs:{deleteClicked:"deleteClicked",commentDeleted:"commentDeleted",postLiked:"postLiked"},decls:1,vars:1,consts:[["class","container",4,"ngFor","ngForOf"],[1,"container"],["mat-card-avatar","",3,"src"],[3,"post",4,"ngIf"],["class","image-container",4,"ngIf"],["align","end",2,"margin-bottom","0"],[2,"margin-right","auto"],["mat-button","",3,"click"],["color","warn"],[3,"comments","loggedinUser","post",4,"ngIf"],[3,"post"],["mat-menu-item","","routerLinkActive","router-link-active",3,"routerLink"],["mat-menu-item","","color","warn",3,"click"],[1,"image-container"],["mat-card-image","",3,"src","alt"],[3,"comments","loggedinUser","post"]],template:function(t,e){1&t&&n.wc(0,x,28,13,"div",0),2&t&&n.kc("ngForOf",e.posts)},directives:[r.k,a.a,a.e,a.c,a.i,a.h,r.l,a.d,a.b,p.b,g.a,h,k.d,d.a,k.c,a.f,y],pipes:[r.e],styles:[".container[_ngcontent-%COMP%]{margin:1rem 0}mat-card-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}.image-container[_ngcontent-%COMP%]{padding:10px;height:300px}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;height:100%}"]}),t})()},f9fP:function(t,e,i){"use strict";var n=i("fXoL"),s=i("3Pt+"),o=i("LRne"),r=i("HDdC");const c=t=>{if(!t.value||"string"==typeof t.value)return Object(o.a)(null);const e=t.value,i=new FileReader;return new r.a(t=>{i.addEventListener("loadend",e=>{const i=new Uint8Array(e.target.result).subarray(0,4);let n="",s=!1;for(const t of i)n+=t.toString(16);switch(n){case"89504e47":s=!0;break;case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":s=!0;break;default:s=!1}t.next(s?null:{invalidMimeType:!0}),t.complete()}),i.readAsArrayBuffer(e)})};var a=i("Wp6s"),l=i("ekhw"),u=i("ofXK"),m=i("bTqV"),b=i("NFeN");function p(t,e){if(1&t&&(n.Tb(0,"div",12),n.Pb(1,"img",13),n.Sb()),2&t){const t=n.fc();n.Cb(1),n.kc("src",t.imagePreview,n.rc)("alt",t.form.value.title)}}i.d(e,"a",(function(){return g}));let g=(()=>{class t{constructor(t){this.fb=t,this.initialFormValue={title:"",content:"",image:""},this.formSubmitted=new n.n,this.form=this.fb.group({title:[this.initialFormValue.title,[s.j.required]],content:[this.initialFormValue.content,[s.j.required]],image:[null,null,[c]]})}ngOnInit(){}ngOnChanges(t){for(const e in t)if(t.hasOwnProperty(e))switch(e){case"initialFormValue":return this.setFormValue()}}setFormValue(){this.form.patchValue({title:this.initialFormValue.title,content:this.initialFormValue.content,image:this.initialFormValue.image}),this.imagePreview=this.initialFormValue.image}onUploadImage(t){const e=t.target.files[0],i=new FileReader;e&&(this.form.patchValue({image:e}),this.form.get("image").updateValueAndValidity(),i.onload=t=>{this.imagePreview=t.target.result},i.readAsDataURL(e))}onFormSubmit(){this.form.markAllAsTouched(),this.form.invalid||this.formSubmitted.emit(this.form.value)}}return t.\u0275fac=function(e){return new(e||t)(n.Ob(s.b))},t.\u0275cmp=n.Ib({type:t,selectors:[["app-post-form"]],inputs:{loggedInUser:"loggedInUser",initialFormValue:"initialFormValue"},outputs:{formSubmitted:"formSubmitted"},features:[n.Ab],decls:18,vars:7,consts:[["mat-card-avatar","",3,"src"],[3,"formGroup","ngSubmit"],["formDirective","ngForm"],["label","Post Title",3,"control"],["label","Post Content","type","textarea",3,"control"],["class","image-preview",4,"ngIf"],[1,"post-form-actions"],["mat-button","","type","button",3,"click"],["color","warn"],["hidden","","type","file",3,"change"],["fileInput",""],["color","primary","mat-button","","type","submit",3,"disabled"],[1,"image-preview"],[3,"src","alt"]],template:function(t,e){if(1&t){const t=n.Ub();n.Tb(0,"mat-card"),n.Tb(1,"mat-card-header"),n.Pb(2,"img",0),n.Tb(3,"mat-card-title"),n.xc(4),n.Sb(),n.Sb(),n.Tb(5,"form",1,2),n.bc("ngSubmit",(function(){return e.onFormSubmit()})),n.Pb(7,"app-input",3),n.Pb(8,"app-input",4),n.wc(9,p,2,2,"div",5),n.Tb(10,"div",6),n.Tb(11,"button",7),n.bc("click",(function(){return n.qc(t),n.oc(15).click()})),n.Tb(12,"mat-icon",8),n.xc(13,"insert_photo"),n.Sb(),n.Sb(),n.Tb(14,"input",9,10),n.bc("change",(function(t){return e.onUploadImage(t)})),n.Sb(),n.Tb(16,"button",11),n.xc(17," Post "),n.Sb(),n.Sb(),n.Sb(),n.Sb()}2&t&&(n.Cb(2),n.kc("src",e.loggedInUser.avatar,n.rc),n.Cb(2),n.yc(e.loggedInUser.name),n.Cb(1),n.kc("formGroup",e.form),n.Cb(2),n.kc("control",e.form.get("title")),n.Cb(1),n.kc("control",e.form.get("content")),n.Cb(1),n.kc("ngIf",e.imagePreview),n.Cb(7),n.kc("disabled",e.form.invalid))},directives:[a.a,a.e,a.c,a.i,s.k,s.g,s.d,l.a,u.l,m.b,b.a],styles:["mat-form-field[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%}.image-preview[_ngcontent-%COMP%]{height:5rem;margin:1rem 0}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}.post-form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]}),t})()},fZDh:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i("fXoL"),s=i("tyNb"),o=i("iz3X"),r=i("oYgl"),c=i("f9fP");let a=(()=>{class t{constructor(t,e,i,n){this.route=t,this.router=e,this.postsService=i,this.authService=n,this.initialFormValue={title:"",content:"",image:""}}ngOnInit(){this.authService.user$.subscribe(t=>{this.loggedInUser=t})}onCreatePost(t){this.postsService.createPost(t).subscribe(()=>{this.router.navigate(["./"],{relativeTo:this.route,queryParams:{ts:Date.now().toString()},queryParamsHandling:"merge",skipLocationChange:!0})})}}return t.\u0275fac=function(e){return new(e||t)(n.Ob(s.a),n.Ob(s.b),n.Ob(o.a),n.Ob(r.a))},t.\u0275cmp=n.Ib({type:t,selectors:[["app-create-post"]],decls:1,vars:2,consts:[[3,"loggedInUser","initialFormValue","formSubmitted"]],template:function(t,e){1&t&&(n.Tb(0,"app-post-form",0),n.bc("formSubmitted",(function(t){return e.onCreatePost(t)})),n.Sb()),2&t&&n.kc("loggedInUser",e.loggedInUser)("initialFormValue",e.initialFormValue)},directives:[c.a],styles:[""]}),t})()},iz3X:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("2Vo4"),s=i("fXoL"),o=i("tk/3");let r=(()=>{class t{constructor(t){this.http=t,this.url="/api/posts",this.posts$=new n.a([]),this.page$=new n.a({pageSize:3,currentPage:1,totalData:0,totalPage:0})}getPosts(){return this.posts$.getValue()}fetchMyPosts(){this.http.get(`${this.url}/me`).subscribe(({data:t})=>{this.posts$.next(t)})}updateMyPost(t,e){let i;return"string"==typeof e.image&&(i=e),"object"==typeof e.image&&(i=new FormData,i.append("title",e.title),i.append("content",e.content),i.append("image",e.image)),this.http.put(`${this.url}/${t}/me`,i)}deleteMyPost(t){const e=this.posts$.getValue();this.posts$.next(this.posts$.getValue().filter(e=>e._id!==t)),this.http.delete(`${this.url}/${t}/me`).subscribe(()=>{},t=>{this.posts$.next(e)})}createPost(t){const e=new FormData;return e.append("title",t.title),e.append("content",t.content),e.append("image",t.image),this.http.post(this.url,e)}fetchPost(t){return this.http.get(`${this.url}/${t}`)}deletePost(t){return this.http.delete(`${this.url}/${t}`)}fetchPosts(t,e){this.http.get(`${this.url}?page=${t}&pageSize=${e}`).subscribe(t=>{this.posts$.next(t.data),this.page$.next(t.page)})}getLikes(t){return this.http.get(`${this.url}/${t}/like`)}likePost(t,e){const i=[...this.getPosts()],n=i.findIndex(e=>e._id===t),s=[...i[n].likes];i[n].likes.find(t=>t===e)?i[n].likes=i[n].likes.filter(t=>t!==e):i[n].likes.push(e),this.posts$.next(i),this.http.patch(`${this.url}/${t}/like`,{userId:e}).subscribe(t=>{if(!t){const t=i[n].likes.findIndex(t=>t===e);i[n].likes.splice(t,1),this.posts$.next(i)}},t=>{i[n].likes=s,this.posts$.next(i)})}createComment(t,e,i){const n=[...this.getPosts()],s=n.findIndex(t=>t._id===e),o=[...n[s].comments];n[s].comments=[...n[s].comments,{user:i._id,avatar:i.avatar,name:i.name,content:t.comment}],this.http.post(`${this.url}/${e}/comments`,t).subscribe(t=>{const e=[...n[s].comments];e[e.length-1]=t},t=>{n[s].comments=o})}deleteComment(t,e){const i=[...this.getPosts()],n=i.findIndex(e=>e._id===t),s=[...i[n].comments],o=i[n].comments.filter(t=>t._id!==e);i[n].comments=o,this.posts$.next(i),this.http.delete(`${this.url}/${t}/comments/${e}`).subscribe(()=>{},t=>{i[n].comments=s})}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(o.b))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},o0se:function(t,e,i){"use strict";i.r(e);var n=i("3Pt+"),s=i("ofXK"),o=i("tyNb"),r=i("eIep"),c=i("fXoL"),a=i("iz3X"),l=i("oYgl"),u=i("y9W9"),m=i("Wp6s"),b=i("bTqV");function p(t,e){if(1&t){const t=c.Ub();c.Tb(0,"mat-card"),c.Tb(1,"p"),c.xc(2),c.Sb(),c.Tb(3,"button",1),c.bc("click",(function(){return c.qc(t),c.fc().onCloseError()})),c.xc(4,"Close"),c.Sb(),c.Sb()}if(2&t){const t=c.fc();c.Cb(2),c.zc("Error occurred: ",t.errorMessage,"")}}let g=(()=>{class t{constructor(){}ngOnInit(){}onCloseError(){this.errorMessage=""}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Ib({type:t,selectors:[["app-error"]],inputs:{errorMessage:"errorMessage"},decls:1,vars:1,consts:[[4,"ngIf"],["align","end","mat-raised-button","",3,"click"]],template:function(t,e){1&t&&c.wc(0,p,5,1,"mat-card",0),2&t&&c.kc("ngIf",e.errorMessage)},directives:[s.l,m.a,b.b],styles:["mat-card[_ngcontent-%COMP%]{display:flex;margin:0 0 1rem;background-color:#f8d7da;color:#721c24}p[_ngcontent-%COMP%]{margin:auto 0!important}button[_ngcontent-%COMP%]{margin-left:auto;color:#721c24}"]}),t})();var d=i("rQ3y"),f=i("f9fP");function h(t,e){1&t&&c.Pb(0,"app-spinner")}function k(t,e){if(1&t){const t=c.Ub();c.Tb(0,"app-post-form",3),c.bc("formSubmitted",(function(e){return c.qc(t),c.fc().onEditPost(e)})),c.Sb()}if(2&t){const t=c.fc();c.kc("loggedInUser",t.loggedInUser)("initialFormValue",t.initialFormValue)}}let S=(()=>{class t{constructor(t,e,i,n,s){this.route=t,this.router=e,this.postsService=i,this.authService=n,this.errorService=s,this.initialFormValue={title:"",content:"",image:""}}ngOnInit(){this.errorSub=this.errorService.error$.subscribe(t=>{this.errorMessage=t.error.message}),this.authSub=this.authService.user$.subscribe(t=>{this.loggedInUser=t}),this.route.paramMap.pipe(Object(r.a)(t=>(this.postId=t.get("id"),this.loading=!0,this.postsService.fetchPost(this.postId)))).subscribe(t=>{this.initialFormValue=t,this.loading=!1})}onEditPost(t){this.postsService.updateMyPost(this.postId,t).subscribe(()=>{this.router.navigate(["../../"],{relativeTo:this.route})})}ngOnDestroy(){this.errorSub.unsubscribe(),this.authSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(o.a),c.Ob(o.b),c.Ob(a.a),c.Ob(l.a),c.Ob(u.a))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-edit-post"]],decls:3,vars:3,consts:[[4,"ngIf"],[3,"errorMessage"],[3,"loggedInUser","initialFormValue","formSubmitted",4,"ngIf"],[3,"loggedInUser","initialFormValue","formSubmitted"]],template:function(t,e){1&t&&(c.wc(0,h,1,0,"app-spinner",0),c.Pb(1,"app-error",1),c.wc(2,k,1,2,"app-post-form",2)),2&t&&(c.kc("ngIf",e.loading),c.Cb(1),c.kc("errorMessage",e.errorMessage),c.Cb(1),c.kc("ngIf",!e.loading))},directives:[s.l,g,d.a,f.a],styles:[""]}),t})();var v=i("M9IT"),C=i("fZDh"),I=i("V7sj");function P(t,e){1&t&&c.Pb(0,"app-spinner")}function y(t,e){if(1&t&&c.Pb(0,"app-error",5),2&t){const t=c.fc(2);c.kc("errorMessage",t.errorMessage)}}function w(t,e){if(1&t){const t=c.Ub();c.Rb(0),c.wc(1,y,1,1,"app-error",3),c.Pb(2,"app-create-post"),c.Tb(3,"app-post-list",4),c.bc("deleteClicked",(function(e){return c.qc(t),c.fc().onDeletePost(e)}))("commentSubmitted",(function(e){return c.qc(t),c.fc().onCommentSubmit(e)}))("postLiked",(function(e){return c.qc(t),c.fc().onClickLike(e)})),c.Sb(),c.Qb()}if(2&t){const t=c.fc();c.Cb(1),c.kc("ngIf",t.errorMessage),c.Cb(2),c.kc("posts",t.posts)("loggedinUser",t.loggedinUser)}}function T(t,e){1&t&&(c.Tb(0,"p",6),c.xc(1," No posts added yet.\n"),c.Sb())}const O=function(){return[1,3,5]},$=[{path:"",component:(()=>{class t{constructor(t,e,i,n,s){this.postsService=t,this.route=e,this.router=i,this.authService=n,this.errorService=s,this.posts=[],this.page={pageSize:3,currentPage:1,totalData:0,totalPage:0}}ngOnInit(){this.userSub=this.authService.user$.subscribe(t=>{this.loggedinUser=t}),this.errorSub=this.errorService.error$.subscribe(t=>{this.loading=!1,this.errorMessage=t.error.message}),this.postsService.posts$.subscribe(t=>{this.loading=!1,this.posts=t}),this.postsService.page$.subscribe(t=>{this.loading=!1,this.page=t}),this.route.queryParamMap.subscribe(t=>{const e=+t.get("page")||this.page.currentPage,i=+t.get("pageSize")||this.page.pageSize;this.loading=!0,this.postsService.fetchPosts(e,i)})}onDeletePost(t){this.loading=!0,this.postsService.deleteMyPost(t)}onClickLike({postId:t}){this.postsService.likePost(t,this.loggedinUser._id)}onCommentSubmit({commentValue:t,postId:e}){this.postsService.createComment(t,e,this.loggedinUser)}onChangePage(t){this.router.navigate(["./"],{relativeTo:this.route,queryParams:{page:t.pageIndex+1,pageSize:t.pageSize}})}ngOnDestroy(){this.userSub.unsubscribe(),this.errorSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(a.a),c.Ob(o.a),c.Ob(o.b),c.Ob(l.a),c.Ob(u.a))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-post-list-home"]],decls:4,vars:7,consts:[[4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],["class","mat-body-1 info-text",4,"ngIf"],[3,"errorMessage",4,"ngIf"],[3,"posts","loggedinUser","deleteClicked","commentSubmitted","postLiked"],[3,"errorMessage"],[1,"mat-body-1","info-text"]],template:function(t,e){1&t&&(c.wc(0,P,1,0,"app-spinner",0),c.wc(1,w,4,3,"ng-container",0),c.Tb(2,"mat-paginator",1),c.bc("page",(function(t){return e.onChangePage(t)})),c.Sb(),c.wc(3,T,2,0,"p",2)),2&t&&(c.kc("ngIf",e.loading),c.Cb(1),c.kc("ngIf",e.loggedinUser&&!e.loading),c.Cb(1),c.kc("length",null==e.page?null:e.page.totalData)("pageSize",null==e.page?null:e.page.pageSize)("pageSizeOptions",c.lc(6,O)),c.Cb(1),c.kc("ngIf",e.posts.length<=0&&!e.loading))},directives:[s.l,v.a,d.a,C.a,I.a,g],styles:[""]}),t})()},{path:":id/edit",component:S}];let x=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},imports:[[o.e.forChild($)],o.e]}),t})();var M=i("rhD1"),U=i("Dk7Y");i.d(e,"PostsModule",(function(){return F}));let F=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},imports:[[s.c,x,M.a,n.i,U.a],x]}),t})()}}]);