function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{V7sj:function(t,e,n){"use strict";var i=n("fXoL"),r=n("0IaG"),o=n("iz3X"),a=n("ofXK"),c=n("rQ3y"),s=n("Wp6s");function u(t,e){1&t&&i.Pb(0,"app-spinner")}function l(t,e){if(1&t&&(i.Tb(0,"div",2),i.Pb(1,"img",3),i.Tb(2,"div",4),i.Tb(3,"strong"),i.xc(4),i.Sb(),i.Sb(),i.Sb()),2&t){var n=e.$implicit;i.Cb(1),i.kc("src",n.avatar,i.rc),i.Cb(3),i.yc(n.name)}}function f(t,e){if(1&t&&(i.Rb(0),i.wc(1,l,5,2,"div",1),i.Qb()),2&t){var n=i.fc();i.Cb(1),i.kc("ngForOf",n.users)}}var m,b,p=((m=function(){function t(e,n,i){_classCallCheck(this,t),this.dialogRef=e,this.postsService=n,this.postId=i.postId}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.loading=!0,this.postsService.getLikes(this.postId).subscribe((function(e){t.loading=!1,t.users=e}))}}]),t}()).\u0275fac=function(t){return new(t||m)(i.Ob(r.g),i.Ob(o.a),i.Ob(r.a))},m.\u0275cmp=i.Ib({type:m,selectors:[["app-likes-dialog"]],decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","style","display: flex; margin-top: 0.5rem",4,"ngFor","ngForOf"],["mat-dialog-content","",2,"display","flex","margin-top","0.5rem"],["mat-card-avatar","",2,"display","block","margin-right","1rem",3,"src"],[2,"margin","auto 0"]],template:function(t,e){1&t&&(i.wc(0,u,1,0,"app-spinner",0),i.wc(1,f,2,1,"ng-container",0)),2&t&&(i.kc("ngIf",e.loading),i.Cb(1),i.kc("ngIf",!e.loading))},directives:[a.l,c.a,a.k,r.e,s.c],styles:[""]}),m),g=n("bTqV"),d=n("NFeN"),h=n("STbY"),v=["*"],k=((b=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||b)},b.\u0275cmp=i.Ib({type:b,selectors:[["app-util-buttons"]],inputs:{post:"post"},ngContentSelectors:v,decls:6,vars:1,consts:[["mat-icon-button","",3,"matMenuTriggerFor"],["more_options","matMenu"]],template:function(t,e){if(1&t&&(i.jc(),i.Tb(0,"button",0),i.Tb(1,"mat-icon"),i.xc(2,"more_horiz"),i.Sb(),i.Sb(),i.Tb(3,"mat-menu",null,1),i.ic(5),i.Sb()),2&t){var n=i.oc(4);i.kc("matMenuTriggerFor",n)}},directives:[g.b,h.c,d.a,h.d],styles:["[_nghost-%COMP%]{display:block;margin-left:auto}"]}),b),y=n("tyNb"),C=n("3Pt+"),S=n("f0Cb"),I=n("ekhw");function _(t,e){if(1&t){var n=i.Ub();i.Tb(0,"app-util-buttons",7),i.Tb(1,"button",8),i.bc("click",(function(){i.qc(n);var t=i.fc().$implicit;return i.fc().onDeleteComment(t._id)})),i.xc(2," Delete "),i.Sb(),i.Sb()}if(2&t){var r=i.fc(2);i.kc("post",r.post)}}function P(t,e){if(1&t&&(i.Tb(0,"div",3),i.Pb(1,"img",4),i.Tb(2,"div",5),i.Tb(3,"strong"),i.xc(4),i.Sb(),i.Tb(5,"div"),i.xc(6),i.Sb(),i.Sb(),i.Tb(7,"div"),i.wc(8,_,3,1,"app-util-buttons",6),i.Sb(),i.Sb()),2&t){var n=e.$implicit,r=i.fc();i.Cb(1),i.kc("src",r.loggedinUser.avatar,i.rc),i.Cb(3),i.yc(r.loggedinUser.name),i.Cb(2),i.zc(" ",n.content," "),i.Cb(2),i.kc("ngIf",r.loggedinUser._id===n.user)}}var w,T=((w=function(){function t(e,n){_classCallCheck(this,t),this.fb=e,this.postsService=n}return _createClass(t,[{key:"ngOnInit",value:function(){this.form=this.fb.group({comment:[""]})}},{key:"onDeleteComment",value:function(t){this.postsService.deleteComment(this.post._id,t)}},{key:"onSubmitComment",value:function(){this.postsService.createComment(this.form.value,this.post._id,this.loggedinUser),this.form.get("comment").setValue("")}}]),t}()).\u0275fac=function(t){return new(t||w)(i.Ob(C.b),i.Ob(o.a))},w.\u0275cmp=i.Ib({type:w,selectors:[["app-comments-section"]],inputs:{comments:"comments",post:"post",loggedinUser:"loggedinUser"},decls:4,vars:3,consts:[[1,"example-form",3,"formGroup","keydown.enter"],["label","Leave a comment",3,"control"],["style","padding: 1rem 0; display: flex",4,"ngFor","ngForOf"],[2,"padding","1rem 0","display","flex"],["mat-card-avatar","",2,"display","block","margin-right","1rem",3,"src"],[2,"flex","3"],[3,"post",4,"ngIf"],[3,"post"],["mat-menu-item","","color","warn",3,"click"]],template:function(t,e){1&t&&(i.Pb(0,"mat-divider"),i.Tb(1,"form",0),i.bc("keydown.enter",(function(){return e.onSubmitComment()})),i.Pb(2,"app-input",1),i.Sb(),i.wc(3,P,9,4,"div",2)),2&t&&(i.Cb(1),i.kc("formGroup",e.form),i.Cb(1),i.kc("control",e.form.get("comment")),i.Cb(1),i.kc("ngForOf",e.comments))},directives:[S.a,C.k,C.g,C.d,I.a,a.k,s.c,a.l,k,h.a],styles:[""]}),w);n.d(e,"a",(function(){return A}));var O=function(t){return["./",t,"edit"]};function x(t,e){if(1&t){var n=i.Ub();i.Tb(0,"app-util-buttons",10),i.Tb(1,"a",11),i.xc(2," Edit "),i.Sb(),i.Tb(3,"button",12),i.bc("click",(function(){i.qc(n);var t=i.fc().$implicit;return i.fc().onDeleteClick(t._id)})),i.xc(4," Delete "),i.Sb(),i.Sb()}if(2&t){var r=i.fc().$implicit;i.kc("post",r),i.Cb(1),i.kc("routerLink",i.mc(2,O,r._id))}}function M(t,e){if(1&t&&(i.Tb(0,"div",13),i.Pb(1,"img",14),i.Sb()),2&t){var n=i.fc().$implicit;i.Cb(1),i.kc("src",n.image,i.rc)("alt",n.title)}}function U(t,e){if(1&t&&i.Pb(0,"app-comments-section",15),2&t){var n=i.fc().$implicit,r=i.fc();i.kc("comments",n.comments)("loggedinUser",r.loggedinUser)("post",n)}}function F(t,e){if(1&t){var n=i.Ub();i.Tb(0,"div",1),i.Tb(1,"mat-card"),i.Tb(2,"mat-card-header"),i.Pb(3,"img",2),i.Tb(4,"mat-card-title"),i.xc(5),i.Sb(),i.Tb(6,"mat-card-subtitle"),i.xc(7),i.gc(8,"date"),i.Sb(),i.wc(9,x,5,4,"app-util-buttons",3),i.Sb(),i.Tb(10,"mat-card-content"),i.Tb(11,"h3"),i.xc(12),i.Sb(),i.Tb(13,"p"),i.xc(14),i.Sb(),i.wc(15,M,2,2,"div",4),i.Sb(),i.Tb(16,"mat-card-actions",5),i.Tb(17,"div",6),i.Tb(18,"button",7),i.bc("click",(function(){i.qc(n);var t=e.$implicit;return i.fc().openLikesDialog(t)})),i.xc(19),i.Sb(),i.Sb(),i.Tb(20,"div"),i.Tb(21,"button",7),i.bc("click",(function(){i.qc(n);var t=e.$implicit;return i.fc().onCommentButtonClick(t._id)})),i.xc(22),i.Sb(),i.Tb(23,"button",7),i.bc("click",(function(){i.qc(n);var t=e.$implicit;return i.fc().onLikeClick(t._id)})),i.Tb(24,"mat-icon",8),i.xc(25),i.Sb(),i.xc(26," LIKE "),i.Sb(),i.Sb(),i.Sb(),i.wc(27,U,1,3,"app-comments-section",9),i.Sb(),i.Sb()}if(2&t){var r=e.$implicit,o=i.fc();i.Cb(3),i.kc("src",r.user.avatar,i.rc),i.Cb(2),i.yc(r.user.name),i.Cb(2),i.yc(i.hc(8,11,r.createdAt)),i.Cb(2),i.kc("ngIf",o.loggedinUser._id===r.user._id),i.Cb(3),i.yc(r.title),i.Cb(2),i.zc(" ",r.content," "),i.Cb(1),i.kc("ngIf",r.image),i.Cb(4),i.zc(" ",o.renderLikes(r)," "),i.Cb(3),i.zc(" ",o.renderCommentButton(r.comments)," "),i.Cb(3),i.yc(o.renderLikeButton(r.likes)),i.Cb(2),i.kc("ngIf",o.commentSection===r._id)}}var L,A=((L=function(){function t(e){_classCallCheck(this,t),this.dialog=e,this.deleteClicked=new i.n,this.commentDeleted=new i.n,this.postLiked=new i.n}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"renderLikes",value:function(t){var e=this;return t.likes.find((function(t){return t===e.loggedinUser._id}))?1===t.likes.length?"You like this post":"You and other ".concat(t.likes.length-1," people like this post"):0===t.likes.length?null:"".concat(t.likes.length," people like this post")}},{key:"renderLikeButton",value:function(t){var e=this;return t.find((function(t){return t===e.loggedinUser._id}))?"favorite":"favorite_border"}},{key:"renderCommentButton",value:function(t){return t.length>0?"".concat(t.length," comments"):t.length<=0?"COMMENT":void 0}},{key:"openLikesDialog",value:function(t){var e=new r.d;e.data={postId:t._id},this.dialog.open(p,e)}},{key:"onLikeClick",value:function(t){this.postLiked.emit({postId:t})}},{key:"onCommentButtonClick",value:function(t){this.commentSection=this.commentSection!==t?t:""}},{key:"onDeleteClick",value:function(t){this.deleteClicked.emit(t)}},{key:"onDeleteComment",value:function(t,e){this.commentDeleted.emit({postId:t,commentId:e})}}]),t}()).\u0275fac=function(t){return new(t||L)(i.Ob(r.b))},L.\u0275cmp=i.Ib({type:L,selectors:[["app-post-list"]],inputs:{posts:"posts",loggedinUser:"loggedinUser"},outputs:{deleteClicked:"deleteClicked",commentDeleted:"commentDeleted",postLiked:"postLiked"},decls:1,vars:1,consts:[["class","container",4,"ngFor","ngForOf"],[1,"container"],["mat-card-avatar","",3,"src"],[3,"post",4,"ngIf"],["class","image-container",4,"ngIf"],["align","end",2,"margin-bottom","0"],[2,"margin-right","auto"],["mat-button","",3,"click"],["color","warn"],[3,"comments","loggedinUser","post",4,"ngIf"],[3,"post"],["mat-menu-item","","routerLinkActive","router-link-active",3,"routerLink"],["mat-menu-item","","color","warn",3,"click"],[1,"image-container"],["mat-card-image","",3,"src","alt"],[3,"comments","loggedinUser","post"]],template:function(t,e){1&t&&i.wc(0,F,28,13,"div",0),2&t&&i.kc("ngForOf",e.posts)},directives:[a.k,s.a,s.e,s.c,s.i,s.h,a.l,s.d,s.b,g.b,d.a,k,y.d,h.a,y.c,s.f,T],pipes:[a.e],styles:[".container[_ngcontent-%COMP%]{margin:1rem 0}mat-card-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}.image-container[_ngcontent-%COMP%]{padding:10px;height:300px}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;height:100%}"]}),L)},f9fP:function(t,e,n){"use strict";var i=n("fXoL"),r=n("3Pt+"),o=n("LRne"),a=n("HDdC"),c=function(t){if(!t.value||"string"==typeof t.value)return Object(o.a)(null);var e=t.value,n=new FileReader;return new a.a((function(t){n.addEventListener("loadend",(function(e){var n,i="",r=!1,o=_createForOfIteratorHelper(new Uint8Array(e.target.result).subarray(0,4));try{for(o.s();!(n=o.n()).done;){i+=n.value.toString(16)}}catch(a){o.e(a)}finally{o.f()}switch(i){case"89504e47":r=!0;break;case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":r=!0;break;default:r=!1}t.next(r?null:{invalidMimeType:!0}),t.complete()})),n.readAsArrayBuffer(e)}))},s=n("Wp6s"),u=n("ekhw"),l=n("ofXK"),f=n("bTqV"),m=n("NFeN");function b(t,e){if(1&t&&(i.Tb(0,"div",12),i.Pb(1,"img",13),i.Sb()),2&t){var n=i.fc();i.Cb(1),i.kc("src",n.imagePreview,i.rc)("alt",n.form.value.title)}}n.d(e,"a",(function(){return g}));var p,g=((p=function(){function t(e){_classCallCheck(this,t),this.fb=e,this.initialFormValue={title:"",content:"",image:""},this.formSubmitted=new i.n,this.form=this.fb.group({title:[this.initialFormValue.title,[r.j.required]],content:[this.initialFormValue.content,[r.j.required]],image:[null,null,[c]]})}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){for(var e in t)if(t.hasOwnProperty(e))switch(e){case"initialFormValue":return this.setFormValue()}}},{key:"setFormValue",value:function(){this.form.patchValue({title:this.initialFormValue.title,content:this.initialFormValue.content,image:this.initialFormValue.image}),this.imagePreview=this.initialFormValue.image}},{key:"onUploadImage",value:function(t){var e=this,n=t.target.files[0],i=new FileReader;n&&(this.form.patchValue({image:n}),this.form.get("image").updateValueAndValidity(),i.onload=function(t){e.imagePreview=t.target.result},i.readAsDataURL(n))}},{key:"onFormSubmit",value:function(){this.form.markAllAsTouched(),this.form.invalid||this.formSubmitted.emit(this.form.value)}}]),t}()).\u0275fac=function(t){return new(t||p)(i.Ob(r.b))},p.\u0275cmp=i.Ib({type:p,selectors:[["app-post-form"]],inputs:{loggedInUser:"loggedInUser",initialFormValue:"initialFormValue"},outputs:{formSubmitted:"formSubmitted"},features:[i.Ab],decls:18,vars:7,consts:[["mat-card-avatar","",3,"src"],[3,"formGroup","ngSubmit"],["formDirective","ngForm"],["label","Post Title",3,"control"],["label","Post Content","type","textarea",3,"control"],["class","image-preview",4,"ngIf"],[1,"post-form-actions"],["mat-button","","type","button",3,"click"],["color","warn"],["hidden","","type","file",3,"change"],["fileInput",""],["color","primary","mat-button","","type","submit",3,"disabled"],[1,"image-preview"],[3,"src","alt"]],template:function(t,e){if(1&t){var n=i.Ub();i.Tb(0,"mat-card"),i.Tb(1,"mat-card-header"),i.Pb(2,"img",0),i.Tb(3,"mat-card-title"),i.xc(4),i.Sb(),i.Sb(),i.Tb(5,"form",1,2),i.bc("ngSubmit",(function(){return e.onFormSubmit()})),i.Pb(7,"app-input",3),i.Pb(8,"app-input",4),i.wc(9,b,2,2,"div",5),i.Tb(10,"div",6),i.Tb(11,"button",7),i.bc("click",(function(){return i.qc(n),i.oc(15).click()})),i.Tb(12,"mat-icon",8),i.xc(13,"insert_photo"),i.Sb(),i.Sb(),i.Tb(14,"input",9,10),i.bc("change",(function(t){return e.onUploadImage(t)})),i.Sb(),i.Tb(16,"button",11),i.xc(17," Post "),i.Sb(),i.Sb(),i.Sb(),i.Sb()}2&t&&(i.Cb(2),i.kc("src",e.loggedInUser.avatar,i.rc),i.Cb(2),i.yc(e.loggedInUser.name),i.Cb(1),i.kc("formGroup",e.form),i.Cb(2),i.kc("control",e.form.get("title")),i.Cb(1),i.kc("control",e.form.get("content")),i.Cb(1),i.kc("ngIf",e.imagePreview),i.Cb(7),i.kc("disabled",e.form.invalid))},directives:[s.a,s.e,s.c,s.i,r.k,r.g,r.d,u.a,l.l,f.b,m.a],styles:["mat-form-field[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%}.image-preview[_ngcontent-%COMP%]{height:5rem;margin:1rem 0}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}.post-form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}"]}),p)},fZDh:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("fXoL"),r=n("tyNb"),o=n("iz3X"),a=n("oYgl"),c=n("f9fP"),s=function(){var t=function(){function t(e,n,i,r){_classCallCheck(this,t),this.route=e,this.router=n,this.postsService=i,this.authService=r,this.initialFormValue={title:"",content:"",image:""}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.authService.user$.subscribe((function(e){t.loggedInUser=e}))}},{key:"onCreatePost",value:function(t){var e=this;this.postsService.createPost(t).subscribe((function(){e.router.navigate(["./"],{relativeTo:e.route,queryParams:{ts:Date.now().toString()},queryParamsHandling:"merge",skipLocationChange:!0})}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Ob(r.a),i.Ob(r.b),i.Ob(o.a),i.Ob(a.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-create-post"]],decls:1,vars:2,consts:[[3,"loggedInUser","initialFormValue","formSubmitted"]],template:function(t,e){1&t&&(i.Tb(0,"app-post-form",0),i.bc("formSubmitted",(function(t){return e.onCreatePost(t)})),i.Sb()),2&t&&i.kc("loggedInUser",e.loggedInUser)("initialFormValue",e.initialFormValue)},directives:[c.a],styles:[""]}),t}()},iz3X:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("2Vo4"),r=n("fXoL"),o=n("tk/3"),a=function(){var t=function(){function t(e){_classCallCheck(this,t),this.http=e,this.url="/api/posts",this.posts$=new i.a([]),this.page$=new i.a({pageSize:3,currentPage:1,totalData:0,totalPage:0})}return _createClass(t,[{key:"getPosts",value:function(){return this.posts$.getValue()}},{key:"fetchMyPosts",value:function(){var t=this;this.http.get("".concat(this.url,"/me")).subscribe((function(e){var n=e.data;t.posts$.next(n)}))}},{key:"updateMyPost",value:function(t,e){var n;return"string"==typeof e.image&&(n=e),"object"==typeof e.image&&((n=new FormData).append("title",e.title),n.append("content",e.content),n.append("image",e.image)),this.http.put("".concat(this.url,"/").concat(t,"/me"),n)}},{key:"deleteMyPost",value:function(t){var e=this,n=this.posts$.getValue();this.posts$.next(this.posts$.getValue().filter((function(e){return e._id!==t}))),this.http.delete("".concat(this.url,"/").concat(t,"/me")).subscribe((function(){}),(function(t){e.posts$.next(n)}))}},{key:"createPost",value:function(t){var e=new FormData;return e.append("title",t.title),e.append("content",t.content),e.append("image",t.image),this.http.post(this.url,e)}},{key:"fetchPost",value:function(t){return this.http.get("".concat(this.url,"/").concat(t))}},{key:"deletePost",value:function(t){return this.http.delete("".concat(this.url,"/").concat(t))}},{key:"fetchPosts",value:function(t,e){var n=this;this.http.get("".concat(this.url,"?page=").concat(t,"&pageSize=").concat(e)).subscribe((function(t){n.posts$.next(t.data),n.page$.next(t.page)}))}},{key:"getLikes",value:function(t){return this.http.get("".concat(this.url,"/").concat(t,"/like"))}},{key:"likePost",value:function(t,e){var n=this,i=_toConsumableArray(this.getPosts()),r=i.findIndex((function(e){return e._id===t})),o=_toConsumableArray(i[r].likes);i[r].likes.find((function(t){return t===e}))?i[r].likes=i[r].likes.filter((function(t){return t!==e})):i[r].likes.push(e),this.posts$.next(i),this.http.patch("".concat(this.url,"/").concat(t,"/like"),{userId:e}).subscribe((function(t){if(!t){var o=i[r].likes.findIndex((function(t){return t===e}));i[r].likes.splice(o,1),n.posts$.next(i)}}),(function(t){i[r].likes=o,n.posts$.next(i)}))}},{key:"createComment",value:function(t,e,n){var i=_toConsumableArray(this.getPosts()),r=i.findIndex((function(t){return t._id===e})),o=_toConsumableArray(i[r].comments);i[r].comments=[].concat(_toConsumableArray(i[r].comments),[{user:n._id,avatar:n.avatar,name:n.name,content:t.comment}]),this.http.post("".concat(this.url,"/").concat(e,"/comments"),t).subscribe((function(t){var e=_toConsumableArray(i[r].comments);e[e.length-1]=t}),(function(t){i[r].comments=o}))}},{key:"deleteComment",value:function(t,e){var n=_toConsumableArray(this.getPosts()),i=n.findIndex((function(e){return e._id===t})),r=_toConsumableArray(n[i].comments),o=n[i].comments.filter((function(t){return t._id!==e}));n[i].comments=o,this.posts$.next(n),this.http.delete("".concat(this.url,"/").concat(t,"/comments/").concat(e)).subscribe((function(){}),(function(t){n[i].comments=r}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(r.Xb(o.b))},t.\u0275prov=r.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},o0se:function(t,e,n){"use strict";n.r(e);var i=n("3Pt+"),r=n("ofXK"),o=n("tyNb"),a=n("eIep"),c=n("fXoL"),s=n("iz3X"),u=n("oYgl"),l=n("y9W9"),f=n("Wp6s"),m=n("bTqV");function b(t,e){if(1&t){var n=c.Ub();c.Tb(0,"mat-card"),c.Tb(1,"p"),c.xc(2),c.Sb(),c.Tb(3,"button",1),c.bc("click",(function(){return c.qc(n),c.fc().onCloseError()})),c.xc(4,"Close"),c.Sb(),c.Sb()}if(2&t){var i=c.fc();c.Cb(2),c.zc("Error occurred: ",i.errorMessage,"")}}var p,g=((p=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"onCloseError",value:function(){this.errorMessage=""}}]),t}()).\u0275fac=function(t){return new(t||p)},p.\u0275cmp=c.Ib({type:p,selectors:[["app-error"]],inputs:{errorMessage:"errorMessage"},decls:1,vars:1,consts:[[4,"ngIf"],["align","end","mat-raised-button","",3,"click"]],template:function(t,e){1&t&&c.wc(0,b,5,1,"mat-card",0),2&t&&c.kc("ngIf",e.errorMessage)},directives:[r.l,f.a,m.b],styles:["mat-card[_ngcontent-%COMP%]{display:flex;margin:0 0 1rem;background-color:#f8d7da;color:#721c24}p[_ngcontent-%COMP%]{margin:auto 0!important}button[_ngcontent-%COMP%]{margin-left:auto;color:#721c24}"]}),p),d=n("rQ3y"),h=n("f9fP");function v(t,e){1&t&&c.Pb(0,"app-spinner")}function k(t,e){if(1&t){var n=c.Ub();c.Tb(0,"app-post-form",3),c.bc("formSubmitted",(function(t){return c.qc(n),c.fc().onEditPost(t)})),c.Sb()}if(2&t){var i=c.fc();c.kc("loggedInUser",i.loggedInUser)("initialFormValue",i.initialFormValue)}}var y,C=((y=function(){function t(e,n,i,r,o){_classCallCheck(this,t),this.route=e,this.router=n,this.postsService=i,this.authService=r,this.errorService=o,this.initialFormValue={title:"",content:"",image:""}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.errorSub=this.errorService.error$.subscribe((function(e){t.errorMessage=e.error.message})),this.authSub=this.authService.user$.subscribe((function(e){t.loggedInUser=e})),this.route.paramMap.pipe(Object(a.a)((function(e){return t.postId=e.get("id"),t.loading=!0,t.postsService.fetchPost(t.postId)}))).subscribe((function(e){t.initialFormValue=e,t.loading=!1}))}},{key:"onEditPost",value:function(t){var e=this;this.postsService.updateMyPost(this.postId,t).subscribe((function(){e.router.navigate(["../../"],{relativeTo:e.route})}))}},{key:"ngOnDestroy",value:function(){this.errorSub.unsubscribe(),this.authSub.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||y)(c.Ob(o.a),c.Ob(o.b),c.Ob(s.a),c.Ob(u.a),c.Ob(l.a))},y.\u0275cmp=c.Ib({type:y,selectors:[["app-edit-post"]],decls:3,vars:3,consts:[[4,"ngIf"],[3,"errorMessage"],[3,"loggedInUser","initialFormValue","formSubmitted",4,"ngIf"],[3,"loggedInUser","initialFormValue","formSubmitted"]],template:function(t,e){1&t&&(c.wc(0,v,1,0,"app-spinner",0),c.Pb(1,"app-error",1),c.wc(2,k,1,2,"app-post-form",2)),2&t&&(c.kc("ngIf",e.loading),c.Cb(1),c.kc("errorMessage",e.errorMessage),c.Cb(1),c.kc("ngIf",!e.loading))},directives:[r.l,g,d.a,h.a],styles:[""]}),y),S=n("M9IT"),I=n("fZDh"),_=n("V7sj");function P(t,e){1&t&&c.Pb(0,"app-spinner")}function w(t,e){if(1&t&&c.Pb(0,"app-error",5),2&t){var n=c.fc(2);c.kc("errorMessage",n.errorMessage)}}function T(t,e){if(1&t){var n=c.Ub();c.Rb(0),c.wc(1,w,1,1,"app-error",3),c.Pb(2,"app-create-post"),c.Tb(3,"app-post-list",4),c.bc("deleteClicked",(function(t){return c.qc(n),c.fc().onDeletePost(t)}))("commentSubmitted",(function(t){return c.qc(n),c.fc().onCommentSubmit(t)}))("postLiked",(function(t){return c.qc(n),c.fc().onClickLike(t)})),c.Sb(),c.Qb()}if(2&t){var i=c.fc();c.Cb(1),c.kc("ngIf",i.errorMessage),c.Cb(2),c.kc("posts",i.posts)("loggedinUser",i.loggedinUser)}}function O(t,e){1&t&&(c.Tb(0,"p",6),c.xc(1," No posts added yet.\n"),c.Sb())}var x,M,U=function(){return[1,3,5]},F=[{path:"",component:(x=function(){function t(e,n,i,r,o){_classCallCheck(this,t),this.postsService=e,this.route=n,this.router=i,this.authService=r,this.errorService=o,this.posts=[],this.page={pageSize:3,currentPage:1,totalData:0,totalPage:0}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.userSub=this.authService.user$.subscribe((function(e){t.loggedinUser=e})),this.errorSub=this.errorService.error$.subscribe((function(e){t.loading=!1,t.errorMessage=e.error.message})),this.postsService.posts$.subscribe((function(e){t.loading=!1,t.posts=e})),this.postsService.page$.subscribe((function(e){t.loading=!1,t.page=e})),this.route.queryParamMap.subscribe((function(e){var n=+e.get("page")||t.page.currentPage,i=+e.get("pageSize")||t.page.pageSize;t.loading=!0,t.postsService.fetchPosts(n,i)}))}},{key:"onDeletePost",value:function(t){this.loading=!0,this.postsService.deleteMyPost(t)}},{key:"onClickLike",value:function(t){var e=t.postId;this.postsService.likePost(e,this.loggedinUser._id)}},{key:"onCommentSubmit",value:function(t){var e=t.commentValue,n=t.postId;this.postsService.createComment(e,n,this.loggedinUser)}},{key:"onChangePage",value:function(t){this.router.navigate(["./"],{relativeTo:this.route,queryParams:{page:t.pageIndex+1,pageSize:t.pageSize}})}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe(),this.errorSub.unsubscribe()}}]),t}(),x.\u0275fac=function(t){return new(t||x)(c.Ob(s.a),c.Ob(o.a),c.Ob(o.b),c.Ob(u.a),c.Ob(l.a))},x.\u0275cmp=c.Ib({type:x,selectors:[["app-post-list-home"]],decls:4,vars:7,consts:[[4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page"],["class","mat-body-1 info-text",4,"ngIf"],[3,"errorMessage",4,"ngIf"],[3,"posts","loggedinUser","deleteClicked","commentSubmitted","postLiked"],[3,"errorMessage"],[1,"mat-body-1","info-text"]],template:function(t,e){1&t&&(c.wc(0,P,1,0,"app-spinner",0),c.wc(1,T,4,3,"ng-container",0),c.Tb(2,"mat-paginator",1),c.bc("page",(function(t){return e.onChangePage(t)})),c.Sb(),c.wc(3,O,2,0,"p",2)),2&t&&(c.kc("ngIf",e.loading),c.Cb(1),c.kc("ngIf",e.loggedinUser&&!e.loading),c.Cb(1),c.kc("length",null==e.page?null:e.page.totalData)("pageSize",null==e.page?null:e.page.pageSize)("pageSizeOptions",c.lc(6,U)),c.Cb(1),c.kc("ngIf",e.posts.length<=0&&!e.loading))},directives:[r.l,S.a,d.a,I.a,_.a,g],styles:[""]}),x)},{path:":id/edit",component:C}],L=((M=function t(){_classCallCheck(this,t)}).\u0275mod=c.Mb({type:M}),M.\u0275inj=c.Lb({factory:function(t){return new(t||M)},imports:[[o.e.forChild(F)],o.e]}),M),A=n("rhD1"),V=n("Dk7Y");n.d(e,"PostsModule",(function(){return D}));var $,D=(($=function t(){_classCallCheck(this,t)}).\u0275mod=c.Mb({type:$}),$.\u0275inj=c.Lb({factory:function(t){return new(t||$)},imports:[[r.c,L,A.a,i.i,V.a],L]}),$)}}]);